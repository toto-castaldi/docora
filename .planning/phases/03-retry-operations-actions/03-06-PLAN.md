---
phase: 03-retry-operations-actions
plan: 06
type: execute
wave: 4
depends_on: ["03-04", "03-05"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Admin can retry a single failed notification from the failed notifications list"
    - "Admin can bulk retry all failed notifications for an app"
    - "Admin can bulk retry all failed notifications globally"
    - "Admin can force full re-sync of a repository"
    - "Admin can force re-sync all repositories for an app"
    - "Retry operations show immediate feedback (loading state, then success/error)"
    - "After successful retry, notification moves from failed to pending in the UI"
    - "Bulk operations show live progress counter"
    - "Bulk operations can be cancelled mid-way"
---

<objective>
Human verification of all Phase 3 retry and re-sync operations.

Purpose: Verify all operational controls work end-to-end before marking phase complete.
Output: Verified phase ready for completion.
</objective>

<execution_context>
@/home/toto/.claude/get-shit-done/workflows/execute-plan.md
@/home/toto/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build dashboard and start services</name>
  <files></files>
  <action>
    1. Build the dashboard: `cd /home/toto/scm-projects/docora && pnpm --filter dashboard build`
    2. Verify typecheck passes: `pnpm typecheck`
    3. Verify main build passes: `pnpm build`
    4. Confirm all new files exist:
       - src/services/admin-actions.ts
       - src/services/bulk-progress.ts
       - src/routes/admin/dashboard-actions.ts (or dashboard-bulk-actions.ts)
       - dashboard/src/components/ConfirmDialog.tsx
       - dashboard/src/components/BulkProgress.tsx
       - dashboard/src/api/admin.ts (updated)
    5. Confirm route registration in src/routes/admin/index.ts
  </action>
  <verify>
    All three commands succeed: `pnpm --filter dashboard build`, `pnpm typecheck`, `pnpm build`
  </verify>
  <done>
    All code compiles and builds successfully.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete retry and re-sync operational controls for Phase 3:
    - Single notification retry (Notifications page + AppDetail page)
    - Bulk retry per-app (AppDetail page)
    - Bulk retry global (Notifications page)
    - Single re-sync (Repositories page + AppDetail page)
    - Bulk re-sync per-app (AppDetail page)
    - ConfirmDialog for destructive operations
    - BulkProgress with live counter and cancel
  </what-built>
  <how-to-verify>
    Start the dev environment (`pnpm dev` + worker + Redis + Postgres).
    Navigate to http://localhost:5173/admin/ and log in.

    **1. Single Retry (Notifications page):**
    - Navigate to "Notifications" in sidebar
    - If there are failed notifications: click "Retry" on one card
    - Verify: button shows loading spinner, toast appears with success/error, card status updates
    - If no failed notifications: verify empty state shows "All notifications delivered"

    **2. Single Retry (AppDetail page):**
    - Navigate to "Apps" -> click an app that has failed repos
    - In the repositories table, find a failed repo and click "Retry"
    - Verify: loading state, toast feedback, status badge changes to Pending

    **3. Bulk Retry All (Notifications page):**
    - On Notifications page with failures, click "Retry All (N)"
    - Verify: confirmation dialog appears with count
    - Click confirm
    - Verify: progress bar appears with "N/M completed" counter updating
    - Wait for completion, verify notification list refreshes

    **4. Bulk Retry by App (AppDetail page):**
    - On an app with failed notifications, click "Retry All Failed"
    - Verify: confirmation dialog, progress bar, completion refresh

    **5. Cancel Bulk Retry:**
    - Start a bulk retry operation
    - Click "Cancel" on the progress bar
    - Verify: remaining items stop, cancelled state shown

    **6. Single Re-sync (Repositories page):**
    - Navigate to "Repositories"
    - Click "Re-sync" on any repo (even synced ones)
    - Verify: confirmation dialog warns about re-sending all files
    - Confirm and verify toast feedback

    **7. Single Re-sync (AppDetail page):**
    - On an app detail page, click "Re-sync" on any repo row
    - Verify same confirmation + feedback

    **8. Bulk Re-sync (AppDetail page):**
    - Click "Re-sync All Repos"
    - Verify: confirmation dialog (danger variant), progress bar, completion

    If no data available to test with, verify the UI elements are present and properly rendered (buttons visible, dialogs open/close, empty states correct).
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 3, or describe any issues found.</resume-signal>
</task>

</tasks>

<verification>
- All builds pass (dashboard, typecheck, main build)
- Human verified: single retry works end-to-end
- Human verified: bulk retry with progress tracking works
- Human verified: cancel stops remaining operations
- Human verified: re-sync with confirmation works
- Human verified: all feedback mechanisms (toast, loading, progress) function correctly
</verification>

<success_criteria>
All Phase 3 success criteria verified:
1. Admin can retry a single failed notification from the failed notifications list
2. Admin can bulk retry all failed notifications for an app
3. Admin can force full re-sync of a repository to recover from edge cases
4. Retry operations show immediate feedback (loading state, then success/error)
5. After successful retry, notification moves from failed to sent in the UI
</success_criteria>

<output>
After completion, create `.planning/phases/03-retry-operations-actions/03-06-SUMMARY.md`
</output>
